generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id                     String                  @id @default(cuid())
  email                  String?                 @unique
  emailVerified          DateTime?
  passwordHash           String?
  firstName              String?
  lastName               String?
  avatar                 String?
  bio                    String?
  role                   UserRole                @default(STUDENT)
  isActive               Boolean                 @default(true)
  lastLoginAt            DateTime?
  createdAt              DateTime                @default(now())
  updatedAt              DateTime                @updatedAt
  hasCompletedOnboarding Boolean                 @default(false)
  assignedCoachId        String?
  certificationGoal      String?
  experienceLevel        String?
  firstLoginAt           DateTime?
  focusAreas             String[]
  hasCompletedProfile    Boolean                 @default(false)
  healthBackground       String?
  leadSource             String?
  leadSourceDetail       String?
  learningGoal           String?
  location               String?
  loginCount             Int                     @default(0)
  phone                  String?
  timezone               String?
  weeklyHours            Int?
  availabilityNote       String?
  avgResponseTime        Int?
  level                  Int                     @default(1)
  personalQuote          String?
  qualifications         String[]
  specialties            String[]
  xp                     Int                     @default(0)
  miniDiplomaCategory    String?
  miniDiplomaOptinAt     DateTime?
  graduateOfferDeadline  DateTime?
  hasCertificateBadge    Boolean                 @default(false)
  miniDiplomaCompletedAt DateTime?
  isFakeProfile          Boolean                 @default(false)
  knowledgeBase          String?
  fbclid                 String?
  fbc                    String?
  fbp                    String?
  userType               UserType                @default(STUDENT)
  accessExpiresAt        DateTime?
  registrationIp         String?
  registrationUserAgent  String?
  registrationDevice     String?
  registrationBrowser    String?
  tosAcceptedAt          DateTime?
  tosVersion             String?
  refundPolicyAcceptedAt DateTime?
  refundPolicyVersion    String?
  cohortId               String?
  slug                   String?                 @unique
  professionalTitle      String?
  acceptingClients       Boolean                 @default(false)
  isPublicDirectory      Boolean                 @default(false)
  website                String?
  socialLinks            Json?
  referralCode           String?                 @unique
  referredBy             String?
  referralCount          Int                     @default(0)
  loginRecovery24hSentAt DateTime?
  loginRecovery3hSentAt  DateTime?
  loginRecovery72hSentAt DateTime?
  loginRecovery7dSentAt  DateTime?
  formVariant            String?
  accounts               Account[]
  auditLogs              AuditLog[]              @relation("AuditLogs")
  bulkDMsSent            BulkDM[]                @relation("BulkDMSender")
  bulkEmailsSent         BulkEmail[]             @relation("BulkEmailSender")
  coachedCommunities     CategoryCommunity[]     @relation("CommunityCoach")
  certificates           Certificate[]
  commentLikes           CommentLike[]
  commentReactions       CommentReaction[]
  communityPosts         CommunityPost[]
  coachedCourses         Course[]                @relation("CourseCoach")
  courseReviews          CourseReview[]
  dfyAssignments         DFYPurchase[]           @relation("DFYAssignments")
  dfyPurchases           DFYPurchase[]
  emailBounces           EmailBounce[]
  emailSends             EmailSend[]
  enrollments            Enrollment[]
  graduatePosts          GraduatePost[]          @relation("UserGraduatePosts")
  incomeLogs             IncomeLog[]             @relation("UserIncomeLogs")
  incomeMilestones       IncomeMilestone[]       @relation("UserIncomeMilestones")
  leadOnboarding         LeadOnboarding?
  lessonChatMessages     LessonChatMessage[]     @relation("LessonChatMessages")
  lessonNotes            LessonNote[]
  progress               LessonProgress[]
  vslSessions            LiveVSLSession[]        @relation("UserVSLSessions")
  loginHistory           LoginHistory[]
  masterclassPod         MasterclassPod?         @relation("UserMasterclassPod")
  mentorSessions         MentorSession[]         @relation("MentorSessions")
  studentSessions        MentorSession[]         @relation("StudentSessions")
  receivedMessages       Message[]               @relation("ReceivedMessages")
  sentMessages           Message[]               @relation("SentMessages")
  miniDiplomaExams       MiniDiplomaExam[]
  moduleProgress         ModuleProgress[]
  notifications          Notification[]
  onboardingProgress     OnboardingProgress?
  oracleActions          OracleAction[]
  oracleEvents           OracleEvent[]
  oracleSegment          OracleSegment?
  passwordResets         PasswordReset[]
  payments               Payment[]
  podEngagements         PodEngagement[]
  podMemberships         PodMember[]             @relation("UserPodMemberships")
  podMessages            PodMessage[]            @relation("UserPodMessages")
  podUserMessages        PodUserMessage[]
  postComments           PostComment[]
  postLikes              PostLike[]
  pushSubscriptions      PushSubscription[]
  quizAttempts           QuizAttempt[]
  quizProgress           QuizProgress[]
  referralsReceived      Referral[]              @relation("UserReferralsReceived")
  referralsSent          Referral[]              @relation("UserReferralsSent")
  resourceDownloads      ResourceDownload[]
  salesChatReplies       SalesChat[]             @relation("SalesChatReplies")
  scheduledVoiceReceived ScheduledVoiceMessage[] @relation("ScheduledVoiceReceiver")
  scheduledVoiceSent     ScheduledVoiceMessage[] @relation("ScheduledVoiceSender")
  sequenceEnrollments    SequenceEnrollment[]
  sessions               Session[]
  smartNudges            SmartNudge[]            @relation("UserSmartNudges")
  successEvents          SuccessEvent[]          @relation("UserSuccessEvents")
  assignedTickets        SupportTicket[]         @relation("AssignedTickets")
  submittedTickets       SupportTicket[]         @relation("UserTickets")
  sentTicketMessages     TicketMessage[]         @relation("SentTicketMessages")
  assignedCoach          User?                   @relation("CoachAssignment", fields: [assignedCoachId], references: [id])
  assignedStudents       User[]                  @relation("CoachAssignment")
  cohort                 Cohort?                 @relation("UserCohort", fields: [cohortId], references: [id])
  badges                 UserBadge[]
  marketingTags          UserMarketingTag[]
  streak                 UserStreak?
  tags                   UserTag[]
  wishlist               Wishlist[]

  @@index([email])
  @@index([role])
  @@index([assignedCoachId])
  @@index([leadSource])
  @@index([lastLoginAt])
  @@index([lastLoginAt, isFakeProfile])
  @@index([isActive])
  @@index([userType])
  @@index([miniDiplomaCategory])
  @@index([miniDiplomaCompletedAt])
  @@index([createdAt])
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@index([userId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model PasswordReset {
  id        String   @id @default(cuid())
  userId    String
  token     String   @unique
  expires   DateTime
  used      Boolean  @default(false)
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([userId])
}

model LeadOnboarding {
  id                   String    @id @default(cuid())
  userId               String    @unique
  watchedVideo         Boolean   @default(false)
  watchedVideoAt       DateTime?
  completedQuestions   Boolean   @default(false)
  completedQuestionsAt DateTime?
  bringReason          String?
  currentSituation     String?
  incomeGoal           String?
  lifeChangeGoal       String?
  doingItFor           String?
  uploadedPhoto        Boolean   @default(false)
  uploadedPhotoAt      DateTime?
  claimedCertificate   Boolean   @default(false)
  claimedCertificateAt DateTime?
  leftReview           Boolean   @default(false)
  leftReviewAt         DateTime?
  reviewPlatform       String?
  createdAt            DateTime  @default(now())
  updatedAt            DateTime  @updatedAt
  user                 User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model Course {
  id                 String              @id @default(cuid())
  title              String
  slug               String              @unique
  description        String
  shortDescription   String?
  thumbnail          String?
  previewVideo       String?
  price              Decimal?            @db.Decimal(10, 2)
  isFree             Boolean             @default(false)
  isPublished        Boolean             @default(false)
  isFeatured         Boolean             @default(false)
  difficulty         Difficulty          @default(BEGINNER)
  duration           Int?
  certificateType    CertificateType     @default(COMPLETION)
  categoryId         String?
  instructorId       String?
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
  publishedAt        DateTime?
  coachId            String?
  regularPrice       Decimal?            @db.Decimal(10, 2)
  metaTitle          String?
  metaDescription    String?
  learningOutcomes   String[]
  targetAudience     String?
  estimatedWeeks     Int?
  enrollmentLimit    Int?
  displayReviews     Int                 @default(0)
  displayEnrollments Int                 @default(0)
  displayRating      Decimal             @default(4.8) @db.Decimal(2, 1)
  socialProofEnabled Boolean             @default(true)
  certificates       Certificate[]
  category           Category?           @relation(fields: [categoryId], references: [id])
  coach              User?               @relation("CourseCoach", fields: [coachId], references: [id])
  analytics          CourseAnalytics?
  reviews            CourseReview[]
  tags               CourseTag[]
  enrollments        Enrollment[]
  lessonChatMessages LessonChatMessage[]
  modules            Module[]
  offers             OfferCourse[]
  payments           Payment[]
  wishlist           Wishlist[]

  @@index([slug])
  @@index([categoryId])
  @@index([coachId])
  @@index([isPublished])
  @@index([isFeatured])
}

model Category {
  id          String             @id @default(cuid())
  name        String             @unique
  slug        String             @unique
  description String?
  icon        String?
  color       String?
  order       Int                @default(0)
  isActive    Boolean            @default(true)
  createdAt   DateTime           @default(now())
  updatedAt   DateTime           @updatedAt
  community   CategoryCommunity?
  channels    CommunityChannel[]
  courses     Course[]

  @@index([slug])
}

model Tag {
  id      String      @id @default(cuid())
  name    String      @unique
  slug    String      @unique
  courses CourseTag[]

  @@index([slug])
}

model CourseTag {
  courseId String
  tagId    String
  course   Course @relation(fields: [courseId], references: [id], onDelete: Cascade)
  tag      Tag    @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([courseId, tagId])
}

model Module {
  id           String           @id @default(cuid())
  title        String
  description  String?
  order        Int              @default(0)
  isPublished  Boolean          @default(false)
  courseId     String
  createdAt    DateTime         @default(now())
  updatedAt    DateTime         @updatedAt
  certificates Certificate[]
  lessons      Lesson[]
  course       Course           @relation(fields: [courseId], references: [id], onDelete: Cascade)
  progress     ModuleProgress[]
  quiz         ModuleQuiz?

  @@index([courseId])
  @@index([order])
}

model Lesson {
  id            String           @id @default(cuid())
  title         String
  description   String?
  content       String?
  videoId       String?
  videoDuration Int?
  order         Int              @default(0)
  isPublished   Boolean          @default(false)
  isFreePreview Boolean          @default(false)
  lessonType    LessonType       @default(VIDEO)
  moduleId      String
  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt
  module        Module           @relation(fields: [moduleId], references: [id], onDelete: Cascade)
  notes         LessonNote[]
  progress      LessonProgress[]
  resources     LessonResource[]

  @@index([moduleId])
  @@index([order])
  @@index([moduleId, order])
  @@index([isPublished, moduleId])
}

model LessonResource {
  id        String             @id @default(cuid())
  title     String
  type      ResourceType
  url       String
  size      Int?
  lessonId  String
  createdAt DateTime           @default(now())
  lesson    Lesson             @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  downloads ResourceDownload[]

  @@index([lessonId])
}

model Enrollment {
  id             String           @id @default(cuid())
  userId         String
  courseId       String
  status         EnrollmentStatus @default(ACTIVE)
  progress       Float            @default(0)
  enrolledAt     DateTime         @default(now())
  completedAt    DateTime?
  expiresAt      DateTime?
  lastAccessedAt DateTime?
  course         Course           @relation(fields: [courseId], references: [id], onDelete: Cascade)
  user           User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, courseId])
  @@index([userId])
  @@index([courseId])
  @@index([status])
  @@index([status, enrolledAt])
  @@index([status, lastAccessedAt])
  @@index([courseId, status])
  @@index([completedAt])
}

model LessonProgress {
  id            String    @id @default(cuid())
  userId        String
  lessonId      String
  isCompleted   Boolean   @default(false)
  watchTime     Int       @default(0)
  lastPosition  Int       @default(0)
  completedAt   DateTime?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  timeSpent     Int       @default(0)
  visitCount    Int       @default(0)
  scrollDepth   Int       @default(0)
  lastVisitedAt DateTime?
  lesson        Lesson    @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, lessonId])
  @@index([userId])
  @@index([lessonId])
  @@index([userId, isCompleted])
}

model LessonNote {
  id        String   @id @default(cuid())
  userId    String
  lessonId  String
  type      NoteType @default(NOTE)
  content   String
  noteText  String?
  position  Int?
  color     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  lesson    Lesson   @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, lessonId])
  @@index([lessonId])
}

model ModuleQuiz {
  id                 String         @id @default(cuid())
  moduleId           String         @unique
  title              String
  description        String?
  passingScore       Int            @default(70)
  maxAttempts        Int?
  timeLimit          Int?
  isRequired         Boolean        @default(true)
  isPublished        Boolean        @default(false)
  showCorrectAnswers Boolean        @default(true)
  createdAt          DateTime       @default(now())
  updatedAt          DateTime       @updatedAt
  module             Module         @relation(fields: [moduleId], references: [id], onDelete: Cascade)
  attempts           QuizAttempt[]
  progress           QuizProgress[]
  questions          QuizQuestion[]

  @@index([moduleId])
}

model QuizQuestion {
  id           String         @id @default(cuid())
  quizId       String
  question     String
  explanation  String?
  questionType QuestionType   @default(MULTIPLE_CHOICE)
  order        Int            @default(0)
  points       Int            @default(1)
  createdAt    DateTime       @default(now())
  answers      QuizAnswer[]
  quiz         ModuleQuiz     @relation(fields: [quizId], references: [id], onDelete: Cascade)
  responses    QuizResponse[]

  @@index([quizId])
  @@index([order])
}

model QuizAnswer {
  id         String       @id @default(cuid())
  questionId String
  answer     String
  isCorrect  Boolean      @default(false)
  order      Int          @default(0)
  question   QuizQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([questionId])
}

model QuizProgress {
  id              String     @id @default(cuid())
  userId          String
  quizId          String
  responses       Json
  currentQuestion Int        @default(0)
  createdAt       DateTime   @default(now())
  updatedAt       DateTime   @updatedAt
  quiz            ModuleQuiz @relation(fields: [quizId], references: [id], onDelete: Cascade)
  user            User       @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, quizId])
  @@index([userId])
  @@index([quizId])
}

model QuizAttempt {
  id             String         @id @default(cuid())
  userId         String
  quizId         String
  score          Int
  pointsEarned   Int            @default(0)
  pointsPossible Int            @default(0)
  passed         Boolean        @default(false)
  timeSpent      Int?
  startedAt      DateTime       @default(now())
  completedAt    DateTime?
  quiz           ModuleQuiz     @relation(fields: [quizId], references: [id], onDelete: Cascade)
  user           User           @relation(fields: [userId], references: [id], onDelete: Cascade)
  responses      QuizResponse[]

  @@index([userId])
  @@index([quizId])
  @@index([passed])
}

model QuizResponse {
  id              String       @id @default(cuid())
  attemptId       String
  questionId      String
  selectedAnswers String[]
  isCorrect       Boolean      @default(false)
  pointsEarned    Int          @default(0)
  attempt         QuizAttempt  @relation(fields: [attemptId], references: [id], onDelete: Cascade)
  question        QuizQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@unique([attemptId, questionId])
  @@index([attemptId])
}

model Certificate {
  id                String          @id @default(cuid())
  certificateNumber String          @unique
  userId            String
  courseId          String
  type              CertificateType
  issuedAt          DateTime        @default(now())
  expiresAt         DateTime?
  pdfUrl            String?
  verificationUrl   String?
  moduleId          String?
  score             Int?
  course            Course          @relation(fields: [courseId], references: [id], onDelete: Cascade)
  module            Module?         @relation(fields: [moduleId], references: [id], onDelete: Cascade)
  user              User            @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, courseId, moduleId])
  @@index([certificateNumber])
  @@index([userId])
  @@index([moduleId])
}

model Wishlist {
  id        String   @id @default(cuid())
  userId    String
  courseId  String
  createdAt DateTime @default(now())
  course    Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, courseId])
  @@index([userId])
  @@index([courseId])
}

model CommunityChannel {
  id          String          @id @default(cuid())
  slug        String          @unique
  name        String
  emoji       String?
  type        ChannelType
  description String?
  isGlobal    Boolean         @default(false)
  categoryId  String?
  sortOrder   Int             @default(0)
  isLocked    Boolean         @default(false)
  adminOnly   Boolean         @default(false)
  autoPost    Boolean         @default(false)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
  category    Category?       @relation(fields: [categoryId], references: [id])
  posts       CommunityPost[]

  @@index([categoryId])
  @@index([isGlobal])
  @@index([type])
  @@index([sortOrder])
}

model Message {
  id             String            @id @default(cuid())
  content        String
  isRead         Boolean           @default(false)
  messageType    MessageType       @default(DIRECT)
  senderId       String
  receiverId     String
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  attachmentName String?
  attachmentType String?
  attachmentUrl  String?
  voiceDuration  Int?
  isAiVoice      Boolean           @default(false)
  replyToId      String?
  transcription  String?
  isScheduled    Boolean           @default(false)
  readAt         DateTime?
  scheduledAt    DateTime?
  receiver       User              @relation("ReceivedMessages", fields: [receiverId], references: [id], onDelete: Cascade)
  replyTo        Message?          @relation("MessageReplies", fields: [replyToId], references: [id])
  replies        Message[]         @relation("MessageReplies")
  sender         User              @relation("SentMessages", fields: [senderId], references: [id], onDelete: Cascade)
  reactions      MessageReaction[]

  @@index([senderId])
  @@index([receiverId])
  @@index([isRead])
  @@index([replyToId])
  @@index([senderId, receiverId])
  @@index([receiverId, createdAt])
  @@index([createdAt])
}

model ScheduledVoiceMessage {
  id           String    @id @default(cuid())
  senderId     String
  receiverId   String
  voiceText    String
  textContent  String
  scheduledFor DateTime
  sentAt       DateTime?
  status       String    @default("PENDING")
  attempts     Int       @default(0)
  lastError    String?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  receiver     User      @relation("ScheduledVoiceReceiver", fields: [receiverId], references: [id], onDelete: Cascade)
  sender       User      @relation("ScheduledVoiceSender", fields: [senderId], references: [id], onDelete: Cascade)

  @@index([status, scheduledFor])
  @@index([receiverId])
}

model MessageReaction {
  id        String   @id @default(cuid())
  messageId String
  userId    String
  emoji     String
  createdAt DateTime @default(now())
  message   Message  @relation(fields: [messageId], references: [id], onDelete: Cascade)

  @@unique([messageId, userId, emoji])
  @@index([messageId])
  @@index([userId])
}

model TypingStatus {
  id         String   @id @default(cuid())
  senderId   String
  receiverId String
  isTyping   Boolean  @default(true)
  updatedAt  DateTime @default(now())

  @@unique([senderId, receiverId])
  @@index([receiverId])
}

model CommunityPost {
  id          String             @id @default(cuid())
  title       String
  content     String
  isPinned    Boolean            @default(false)
  isLocked    Boolean            @default(false)
  viewCount   Int                @default(0)
  authorId    String
  categoryId  String?
  createdAt   DateTime           @default(now())
  updatedAt   DateTime           @updatedAt
  likeCount   Int                @default(0)
  communityId String?
  reactions   Json?
  channelId   String?
  author      User               @relation(fields: [authorId], references: [id], onDelete: Cascade)
  channel     CommunityChannel?  @relation(fields: [channelId], references: [id])
  community   CategoryCommunity? @relation(fields: [communityId], references: [id])
  comments    PostComment[]
  likes       PostLike[]

  @@index([authorId])
  @@index([isPinned])
  @@index([communityId])
  @@index([channelId])
}

model PostLike {
  id        String        @id @default(cuid())
  postId    String
  userId    String
  createdAt DateTime      @default(now())
  post      CommunityPost @relation(fields: [postId], references: [id], onDelete: Cascade)
  user      User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([postId, userId])
  @@index([postId])
  @@index([userId])
}

model PostComment {
  id        String            @id @default(cuid())
  content   String
  postId    String
  authorId  String
  parentId  String?
  createdAt DateTime          @default(now())
  updatedAt DateTime          @updatedAt
  likeCount Int               @default(0)
  likes     CommentLike[]
  reactions CommentReaction[]
  author    User              @relation(fields: [authorId], references: [id], onDelete: Cascade)
  parent    PostComment?      @relation("CommentReplies", fields: [parentId], references: [id])
  replies   PostComment[]     @relation("CommentReplies")
  post      CommunityPost     @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([postId])
  @@index([authorId])
}

model CommentLike {
  id        String      @id @default(cuid())
  commentId String
  userId    String
  createdAt DateTime    @default(now())
  comment   PostComment @relation(fields: [commentId], references: [id], onDelete: Cascade)
  user      User        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([commentId, userId])
  @@index([commentId])
  @@index([userId])
}

model CommentReaction {
  id        String      @id @default(cuid())
  commentId String
  userId    String
  emoji     String
  createdAt DateTime    @default(now())
  comment   PostComment @relation(fields: [commentId], references: [id], onDelete: Cascade)
  user      User        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([commentId, userId, emoji])
  @@index([commentId])
  @@index([userId])
}

model MentorSession {
  id          String        @id @default(cuid())
  mentorId    String
  studentId   String
  status      SessionStatus @default(PENDING)
  scheduledAt DateTime?
  duration    Int?
  notes       String?
  meetingUrl  String?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  mentor      User          @relation("MentorSessions", fields: [mentorId], references: [id], onDelete: Cascade)
  student     User          @relation("StudentSessions", fields: [studentId], references: [id], onDelete: Cascade)

  @@index([mentorId])
  @@index([studentId])
  @@index([status])
}

model Notification {
  id        String           @id @default(cuid())
  userId    String
  type      NotificationType
  title     String
  message   String
  data      Json?
  isRead    Boolean          @default(false)
  createdAt DateTime         @default(now())
  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([isRead])
  @@index([type])
}

model WebhookEvent {
  id          String    @id @default(cuid())
  eventType   String
  payload     Json
  status      String    @default("pending")
  attempts    Int       @default(0)
  lastError   String?
  createdAt   DateTime  @default(now())
  processedAt DateTime?

  @@index([eventType])
  @@index([status])
}

model WebhookEndpoint {
  id        String   @id @default(cuid())
  url       String
  secret    String
  events    String[]
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([isActive])
}

model BulkEmail {
  id            String          @id @default(cuid())
  subject       String
  content       String
  status        BulkEmailStatus @default(DRAFT)
  recipientType String
  filters       Json?
  sentCount     Int             @default(0)
  failedCount   Int             @default(0)
  scheduledAt   DateTime?
  sentAt        DateTime?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  senderId      String?
  sender        User?           @relation("BulkEmailSender", fields: [senderId], references: [id])

  @@index([status])
  @@index([senderId])
}

model BulkDM {
  id            String          @id @default(cuid())
  content       String
  status        BulkEmailStatus @default(DRAFT)
  recipientType String
  filters       Json?
  sentCount     Int             @default(0)
  failedCount   Int             @default(0)
  scheduledAt   DateTime?
  sentAt        DateTime?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  senderId      String?
  sender        User?           @relation("BulkDMSender", fields: [senderId], references: [id])

  @@index([status])
  @@index([senderId])
}

model CourseAnalytics {
  id             String   @id @default(cuid())
  courseId       String   @unique
  totalEnrolled  Int      @default(0)
  totalCompleted Int      @default(0)
  avgProgress    Float    @default(0)
  avgRating      Float    @default(0)
  totalRevenue   Decimal  @default(0) @db.Decimal(12, 2)
  updatedAt      DateTime @updatedAt
  course         Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@index([courseId])
}

model UserActivity {
  id        String   @id @default(cuid())
  userId    String
  action    String
  metadata  Json?
  ipAddress String?
  userAgent String?
  createdAt DateTime @default(now())

  @@index([userId])
  @@index([action])
  @@index([createdAt])
}

model CourseReview {
  id         String   @id @default(cuid())
  userId     String
  courseId   String
  rating     Int
  title      String?
  content    String
  isPublic   Boolean  @default(true)
  isVerified Boolean  @default(false)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  course     Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, courseId])
  @@index([courseId])
  @@index([rating])
}

model Badge {
  id          String      @id @default(cuid())
  name        String      @unique
  slug        String      @unique
  description String
  icon        String
  color       String
  criteria    String
  points      Int         @default(0)
  createdAt   DateTime    @default(now())
  userBadges  UserBadge[]

  @@index([slug])
}

model UserBadge {
  id       String   @id @default(cuid())
  userId   String
  badgeId  String
  earnedAt DateTime @default(now())
  metadata Json?
  badge    Badge    @relation(fields: [badgeId], references: [id], onDelete: Cascade)
  user     User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, badgeId])
  @@index([userId])
}

model UserStreak {
  id            String   @id @default(cuid())
  userId        String   @unique
  currentStreak Int      @default(0)
  longestStreak Int      @default(0)
  lastActiveAt  DateTime @default(now())
  totalPoints   Int      @default(0)
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model ModuleProgress {
  id          String    @id @default(cuid())
  userId      String
  moduleId    String
  isCompleted Boolean   @default(false)
  completedAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  module      Module    @relation(fields: [moduleId], references: [id], onDelete: Cascade)
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, moduleId])
  @@index([userId])
  @@index([moduleId])
}

model UserTag {
  id        String   @id @default(cuid())
  userId    String
  tag       String
  value     String?
  metadata  Json?
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, tag])
  @@index([userId])
  @@index([tag])
  @@index([createdAt])
}

model LoginHistory {
  id           String   @id @default(cuid())
  userId       String
  ipAddress    String?
  userAgent    String?
  location     String?
  device       String?
  browser      String?
  isFirstLogin Boolean  @default(false)
  loginMethod  String?
  createdAt    DateTime @default(now())
  country      String?
  countryCode  String?
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([createdAt])
  @@index([isFirstLogin])
}

model NicheCoach {
  id          String   @id @default(cuid())
  niche       String   @unique
  coachId     String
  displayName String
  description String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([niche])
  @@index([coachId])
}

model CategoryCommunity {
  id          String          @id @default(cuid())
  categoryId  String          @unique
  name        String
  description String?
  welcomePost String?
  coachId     String
  isActive    Boolean         @default(true)
  memberCount Int             @default(0)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
  category    Category        @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  coach       User            @relation("CommunityCoach", fields: [coachId], references: [id])
  posts       CommunityPost[]

  @@index([categoryId])
  @@index([coachId])
  @@index([isActive])
}

model AutoMessage {
  id           String   @id @default(cuid())
  trigger      String
  triggerValue String?
  fromCoachId  String?
  subject      String?
  content      String
  messageType  String   @default("dm")
  isActive     Boolean  @default(true)
  delayMinutes Int      @default(0)
  priority     Int      @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([trigger])
  @@index([isActive])
}

model SpecialOffer {
  id             String            @id @default(cuid())
  title          String
  description    String?
  code           String?           @unique
  discountType   String
  discountValue  Decimal           @db.Decimal(10, 2)
  minPurchase    Decimal?          @db.Decimal(10, 2)
  maxUses        Int?
  maxUsesPerUser Int?
  usedCount      Int               @default(0)
  isActive       Boolean           @default(true)
  isFeatured     Boolean           @default(false)
  startsAt       DateTime          @default(now())
  expiresAt      DateTime?
  bannerColor    String?
  bannerIcon     String?
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  courses        OfferCourse[]
  redemptions    OfferRedemption[]

  @@index([isActive])
  @@index([code])
  @@index([startsAt])
  @@index([expiresAt])
}

model OfferCourse {
  id       String       @id @default(cuid())
  offerId  String
  courseId String
  course   Course       @relation(fields: [courseId], references: [id], onDelete: Cascade)
  offer    SpecialOffer @relation(fields: [offerId], references: [id], onDelete: Cascade)

  @@unique([offerId, courseId])
  @@index([offerId])
  @@index([courseId])
}

model OfferRedemption {
  id          String       @id @default(cuid())
  offerId     String
  userId      String
  courseId    String?
  savedAmount Decimal      @db.Decimal(10, 2)
  createdAt   DateTime     @default(now())
  offer       SpecialOffer @relation(fields: [offerId], references: [id], onDelete: Cascade)

  @@index([offerId])
  @@index([userId])
}

model MarketingTag {
  id               String             @id @default(cuid())
  name             String             @unique
  slug             String             @unique
  category         TagCategory
  color            String             @default("#6B7280")
  description      String?
  isSystem         Boolean            @default(false)
  isActive         Boolean            @default(true)
  userCount        Int                @default(0)
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  sequenceExits    Sequence[]         @relation("SequenceExitTag")
  sequenceTriggers Sequence[]         @relation("SequenceTriggerTag")
  userTags         UserMarketingTag[]

  @@index([slug])
  @@index([category])
  @@index([isActive])
}

model UserMarketingTag {
  id        String       @id @default(cuid())
  userId    String
  tagId     String
  source    String?
  metadata  Json?
  createdAt DateTime     @default(now())
  tag       MarketingTag @relation(fields: [tagId], references: [id], onDelete: Cascade)
  user      User         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, tagId])
  @@index([userId])
  @@index([tagId])
  @@index([createdAt])
}

model Sequence {
  id             String               @id @default(cuid())
  name           String
  slug           String               @unique
  description    String?
  triggerType    SequenceTrigger
  triggerTagId   String?
  exitTagId      String?
  exitOnReply    Boolean              @default(false)
  exitOnClick    Boolean              @default(false)
  isActive       Boolean              @default(false)
  isSystem       Boolean              @default(false)
  priority       Int                  @default(0)
  totalEnrolled  Int                  @default(0)
  totalCompleted Int                  @default(0)
  totalExited    Int                  @default(0)
  createdAt      DateTime             @default(now())
  updatedAt      DateTime             @updatedAt
  courseCategory String?
  exitTag        MarketingTag?        @relation("SequenceExitTag", fields: [exitTagId], references: [id])
  triggerTag     MarketingTag?        @relation("SequenceTriggerTag", fields: [triggerTagId], references: [id])
  emails         SequenceEmail[]
  enrollments    SequenceEnrollment[]

  @@index([slug])
  @@index([isActive])
  @@index([triggerType])
}

model SequenceEmail {
  id              String         @id @default(cuid())
  sequenceId      String
  emailTemplateId String?
  customSubject   String?
  customContent   String?
  order           Int            @default(0)
  delayDays       Int            @default(0)
  delayHours      Int            @default(0)
  sendAtHour      Int?
  sendOnWeekends  Boolean        @default(false)
  requiresTagId   String?
  skipIfTagId     String?
  isActive        Boolean        @default(true)
  sentCount       Int            @default(0)
  openCount       Int            @default(0)
  clickCount      Int            @default(0)
  replyCount      Int            @default(0)
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  sends           EmailSend[]
  emailTemplate   EmailTemplate? @relation(fields: [emailTemplateId], references: [id])
  sequence        Sequence       @relation(fields: [sequenceId], references: [id], onDelete: Cascade)

  @@index([sequenceId])
  @@index([order])
}

model SequenceEnrollment {
  id                String                   @id @default(cuid())
  userId            String
  sequenceId        String
  status            SequenceEnrollmentStatus @default(ACTIVE)
  currentEmailIndex Int                      @default(0)
  nextSendAt        DateTime?
  enrolledAt        DateTime                 @default(now())
  completedAt       DateTime?
  exitedAt          DateTime?
  exitReason        String?
  emailsReceived    Int                      @default(0)
  emailsOpened      Int                      @default(0)
  emailsClicked     Int                      @default(0)
  sequence          Sequence                 @relation(fields: [sequenceId], references: [id], onDelete: Cascade)
  user              User                     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, sequenceId])
  @@index([userId])
  @@index([sequenceId])
  @@index([status])
  @@index([nextSendAt])
}

model EmailSend {
  id                 String         @id @default(cuid())
  userId             String?
  emailTemplateId    String?
  sequenceEmailId    String?
  resendId           String?        @unique
  toEmail            String
  subject            String
  preheader          String?
  status             EmailStatus    @default(QUEUED)
  sentAt             DateTime?
  deliveredAt        DateTime?
  openedAt           DateTime?
  clickedAt          DateTime?
  bouncedAt          DateTime?
  complainedAt       DateTime?
  unsubscribedAt     DateTime?
  openCount          Int            @default(0)
  clickCount         Int            @default(0)
  clickedLinks       String[]
  errorMessage       String?
  createdAt          DateTime       @default(now())
  updatedAt          DateTime       @updatedAt
  attemptCount       Int            @default(0)
  emailType          String?
  externalId         String?
  lastError          String?
  maxAttempts        Int            @default(5)
  neverBounceChecked Boolean        @default(false)
  neverBounceResult  String?
  provider           String         @default("resend")
  retryAfter         DateTime?
  events             EmailEvent[]
  emailTemplate      EmailTemplate? @relation(fields: [emailTemplateId], references: [id])
  sequenceEmail      SequenceEmail? @relation(fields: [sequenceEmailId], references: [id])
  user               User?          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([emailTemplateId])
  @@index([sequenceEmailId])
  @@index([resendId])
  @@index([status])
  @@index([sentAt])
  @@index([provider])
  @@index([retryAfter])
  @@index([toEmail])
}

model EmailEvent {
  id          String    @id @default(cuid())
  emailSendId String
  eventType   String
  eventData   Json?
  createdAt   DateTime  @default(now())
  emailSend   EmailSend @relation(fields: [emailSendId], references: [id], onDelete: Cascade)

  @@index([emailSendId])
  @@index([eventType])
  @@index([createdAt])
}

model EmailBounce {
  id                   String    @id @default(cuid())
  userId               String
  originalEmail        String
  bounceType           String
  bounceCount          Int       @default(1)
  bounceReason         String?
  suggestedEmail       String?
  suggestionSource     String?
  suggestionConfidence Float?
  neverBounceResult    String?
  neverBounceCheckedAt DateTime?
  status               String    @default("pending")
  fixedAt              DateTime?
  fixedBy              String?
  resendAttempted      Boolean   @default(false)
  resendSucceeded      Boolean?
  resendEmailId        String?
  createdAt            DateTime  @default(now())
  updatedAt            DateTime  @updatedAt
  user                 User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, originalEmail])
  @@index([status])
  @@index([bounceType])
  @@index([createdAt])
}

model MetaEventLog {
  id        String   @id @default(cuid())
  eventName String
  eventId   String
  userEmail String?
  pixelId   String?
  payload   Json?
  response  Json?
  status    String   @default("pending")
  createdAt DateTime @default(now())

  @@index([eventName])
  @@index([userEmail])
  @@index([createdAt])
}

model EmailAnalytics {
  id           String   @id @default(cuid())
  date         DateTime @unique @db.Date
  sent         Int      @default(0)
  delivered    Int      @default(0)
  bounced      Int      @default(0)
  complained   Int      @default(0)
  opened       Int      @default(0)
  uniqueOpens  Int      @default(0)
  clicked      Int      @default(0)
  uniqueClicks Int      @default(0)
  unsubscribed Int      @default(0)
  deliveryRate Float    @default(0)
  openRate     Float    @default(0)
  clickRate    Float    @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([date])
}

model UserCreditProfile {
  id                String     @id @default(cuid())
  userId            String     @unique
  creditScore       Int?
  creditTier        CreditTier @default(UNKNOWN)
  incomeRange       String?
  employmentStatus  String?
  financingInterest Boolean    @default(false)
  lastUpdated       DateTime   @default(now())
  recommendedTier   String?
  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt

  @@index([userId])
  @@index([creditTier])
}

model UserBehavior {
  id           String   @id @default(cuid())
  userId       String
  behaviorType String
  entityId     String?
  count        Int      @default(1)
  metadata     Json?
  lastOccurred DateTime @default(now())
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@unique([userId, behaviorType, entityId])
  @@index([userId])
  @@index([behaviorType])
  @@index([lastOccurred])
}

model ScheduledJob {
  id           String    @id @default(cuid())
  jobType      String
  referenceId  String?
  userId       String?
  payload      Json
  scheduledFor DateTime
  status       JobStatus @default(PENDING)
  attempts     Int       @default(0)
  maxAttempts  Int       @default(3)
  lastError    String?
  executedAt   DateTime?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  @@index([status])
  @@index([scheduledFor])
  @@index([jobType])
}

model Challenge {
  id           String                @id @default(cuid())
  title        String
  slug         String                @unique
  description  String
  thumbnail    String?
  durationDays Int                   @default(7)
  unlockTime   String                @default("08:00")
  isActive     Boolean               @default(true)
  isFeatured   Boolean               @default(false)
  createdAt    DateTime              @default(now())
  updatedAt    DateTime              @updatedAt
  badges       ChallengeBadge[]
  enrollments  ChallengeEnrollment[]
  modules      ChallengeModule[]

  @@index([slug])
  @@index([isActive])
}

model ChallengeModule {
  id              String    @id @default(cuid())
  challengeId     String
  day             Int
  title           String
  description     String?
  videoId         String?
  content         String?
  actionTask      String?
  communityPrompt String?
  createdAt       DateTime  @default(now())
  challenge       Challenge @relation(fields: [challengeId], references: [id], onDelete: Cascade)

  @@unique([challengeId, day])
  @@index([challengeId])
}

model ChallengeEnrollment {
  id            String    @id @default(cuid())
  userId        String
  challengeId   String
  startedAt     DateTime  @default(now())
  currentDay    Int       @default(1)
  completedDays Int[]     @default([])
  completedAt   DateTime?
  challenge     Challenge @relation(fields: [challengeId], references: [id], onDelete: Cascade)

  @@unique([userId, challengeId])
  @@index([userId])
  @@index([challengeId])
}

model ChallengeBadge {
  id          String    @id @default(cuid())
  challengeId String
  day         Int
  name        String
  icon        String
  description String?
  challenge   Challenge @relation(fields: [challengeId], references: [id], onDelete: Cascade)

  @@unique([challengeId, day])
  @@index([challengeId])
}

model Resource {
  id            String           @id @default(cuid())
  title         String
  description   String?
  thumbnail     String?
  category      ResourceCategory
  accessLevel   ResourceAccess   @default(FREE)
  downloadCount Int              @default(0)
  isActive      Boolean          @default(true)
  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt
  files         ResourceFile[]

  @@index([category])
  @@index([accessLevel])
}

model ResourceFile {
  id         String   @id @default(cuid())
  resourceId String
  name       String
  url        String
  fileType   String
  size       Int?
  createdAt  DateTime @default(now())
  resource   Resource @relation(fields: [resourceId], references: [id], onDelete: Cascade)

  @@index([resourceId])
}

model Client {
  id              String           @id @default(cuid())
  coachId         String
  name            String
  email           String?
  phone           String?
  avatar          String?
  notes           String?
  tags            String[]
  status          ClientStatus     @default(ACTIVE)
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  allergies       String[]
  assessments     Json?
  conditions      String[]
  currentHealth   String?
  dateOfBirth     DateTime?
  dietType        String?
  exerciseFreq    String?
  familyHistory   String?
  gender          String?
  healthGoals     String?
  lastSession     DateTime?
  medications     String[]
  nextSession     DateTime?
  occupation      String?
  packageType     String?
  primaryConcerns String?
  sleepHours      Float?
  startDate       DateTime?
  stressLevel     Int?
  supplements     String[]
  surgeries       String?
  timezone        String?
  totalSessions   Int              @default(0)
  protocols       ClientProtocol[]
  sessions        ClientSession[]
  tasks           ClientTask[]

  @@index([coachId])
  @@index([status])
}

model ClientSession {
  id          String   @id @default(cuid())
  clientId    String
  date        DateTime
  duration    Int?
  notes       String?
  sessionType String?
  createdAt   DateTime @default(now())
  client      Client   @relation(fields: [clientId], references: [id], onDelete: Cascade)

  @@index([clientId])
  @@index([date])
}

model ClientProtocol {
  id          String         @id @default(cuid())
  clientId    String
  name        String
  description String?
  steps       Json
  startDate   DateTime?
  endDate     DateTime?
  status      ProtocolStatus @default(ACTIVE)
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt
  client      Client         @relation(fields: [clientId], references: [id], onDelete: Cascade)

  @@index([clientId])
}

model ClientTask {
  id          String    @id @default(cuid())
  clientId    String
  task        String
  description String?
  dueDate     DateTime?
  completed   Boolean   @default(false)
  completedAt DateTime?
  priority    String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  client      Client    @relation(fields: [clientId], references: [id], onDelete: Cascade)

  @@index([clientId])
  @@index([dueDate])
  @@index([completed])
}

model Ebook {
  id          String          @id @default(cuid())
  title       String
  author      String?
  description String?
  coverImage  String?
  isFeatured  Boolean         @default(false)
  isPublished Boolean         @default(false)
  accessLevel ResourceAccess  @default(FREE)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
  chapters    EbookChapter[]
  progress    EbookProgress[]

  @@index([isPublished])
}

model EbookChapter {
  id        String   @id @default(cuid())
  ebookId   String
  title     String
  content   String
  order     Int      @default(0)
  createdAt DateTime @default(now())
  ebook     Ebook    @relation(fields: [ebookId], references: [id], onDelete: Cascade)

  @@index([ebookId])
  @@index([order])
}

model EbookProgress {
  id             String    @id @default(cuid())
  userId         String
  ebookId        String
  currentChapter Int       @default(0)
  completedAt    DateTime?
  bookmarks      Json?
  highlights     Json?
  updatedAt      DateTime  @updatedAt
  ebook          Ebook     @relation(fields: [ebookId], references: [id], onDelete: Cascade)

  @@unique([userId, ebookId])
  @@index([userId])
  @@index([ebookId])
}

model DFYProduct {
  id               String           @id @default(cuid())
  title            String
  slug             String           @unique
  description      String
  shortDescription String?
  thumbnail        String?
  previewImage     String?
  price            Decimal          @db.Decimal(10, 2)
  compareAtPrice   Decimal?         @db.Decimal(10, 2)
  productType      DFYProductType
  category         String
  specialty        String?
  duration         String?
  sessionsCount    Int?
  materialsCount   Int?
  isActive         Boolean          @default(true)
  isFeatured       Boolean          @default(false)
  isBestseller     Boolean          @default(false)
  sortOrder        Int              @default(0)
  features         String[]
  highlights       String[]
  bundleProductIds String[]
  bundleDiscount   Decimal?         @db.Decimal(10, 2)
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
  avgRating        Float            @default(5.0)
  reviewCount      Int              @default(0)
  files            DFYProductFile[]
  purchases        DFYPurchase[]

  @@index([slug])
  @@index([category])
  @@index([specialty])
  @@index([productType])
  @@index([isActive])
  @@index([isFeatured])
}

model DFYProductFile {
  id          String     @id @default(cuid())
  productId   String
  name        String
  description String?
  fileUrl     String
  fileType    String
  fileSize    Int?
  category    String?
  sortOrder   Int        @default(0)
  createdAt   DateTime   @default(now())
  product     DFYProduct @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([productId])
  @@index([category])
}

model DFYPurchase {
  id                String            @id @default(cuid())
  userId            String
  productId         String
  purchasePrice     Decimal           @db.Decimal(10, 2)
  discountApplied   Decimal?          @db.Decimal(10, 2)
  promoCode         String?
  status            PurchaseStatus    @default(COMPLETED)
  createdAt         DateTime          @default(now())
  assignedToId      String?
  deliveredAt       DateTime?
  fulfillmentStatus FulfillmentStatus @default(PENDING)
  intakeData        Json?
  notes             String?
  updatedAt         DateTime          @updatedAt
  assignedTo        User?             @relation("DFYAssignments", fields: [assignedToId], references: [id])
  product           DFYProduct        @relation(fields: [productId], references: [id])
  user              User              @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, productId])
  @@index([userId])
  @@index([productId])
  @@index([status])
  @@index([fulfillmentStatus])
  @@index([assignedToId])
}

model CoachProgramTemplate {
  id           String   @id @default(cuid())
  coachId      String
  dfyProductId String?
  name         String
  description  String?
  duration     Int
  structure    Json
  isActive     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@index([coachId])
  @@index([dfyProductId])
}

model EmailTemplate {
  id             String          @id @default(cuid())
  slug           String          @unique
  name           String
  description    String?
  category       EmailCategory   @default(ACCOUNT)
  subject        String
  preheader      String?
  htmlContent    String
  textContent    String?
  courseTag      String?
  placeholders   String[]
  isActive       Boolean         @default(true)
  isSystem       Boolean         @default(false)
  sentCount      Int             @default(0)
  openCount      Int             @default(0)
  clickCount     Int             @default(0)
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  emailSends     EmailSend[]
  sequenceEmails SequenceEmail[]

  @@index([slug])
  @@index([category])
  @@index([courseTag])
  @@index([isActive])
}

model SalesChat {
  id            String   @id @default(cuid())
  visitorId     String
  page          String
  message       String
  isFromVisitor Boolean  @default(true)
  isRead        Boolean  @default(false)
  repliedBy     String?
  visitorName   String?
  visitorEmail  String?
  createdAt     DateTime @default(now())
  repliedByUser User?    @relation("SalesChatReplies", fields: [repliedBy], references: [id])

  @@index([visitorId])
  @@index([page])
  @@index([isRead])
  @@index([createdAt])
}

model ChatOptin {
  id              String    @id @default(cuid())
  visitorId       String    @unique
  name            String
  email           String?
  page            String
  ipAddress       String?
  userAgent       String?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  emailsSent      Int       @default(0)
  lastEmailSentAt DateTime?

  @@index([email])
  @@index([createdAt])
}

model SupportTicket {
  id              String           @id @default(cuid())
  ticketNumber    Int              @unique @default(autoincrement())
  subject         String
  status          TicketStatus     @default(NEW)
  priority        TicketPriority   @default(MEDIUM)
  category        TicketCategory   @default(GENERAL)
  customerName    String
  customerEmail   String
  userId          String?
  assignedToId    String?
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
  firstResponseAt DateTime?
  resolvedAt      DateTime?
  closedAt        DateTime?
  rating          Int?
  ratingComment   String?
  ratedAt         DateTime?
  department      TicketDepartment @default(SUPPORT)
  assignedTo      User?            @relation("AssignedTickets", fields: [assignedToId], references: [id])
  user            User?            @relation("UserTickets", fields: [userId], references: [id])
  messages        TicketMessage[]

  @@index([status])
  @@index([priority])
  @@index([category])
  @@index([department])
  @@index([customerEmail])
  @@index([userId])
  @@index([assignedToId])
  @@index([createdAt])
  @@index([status, priority, createdAt])
  @@index([status, createdAt])
  @@index([rating])
  @@index([updatedAt])
}

model TicketMessage {
  id             String        @id @default(cuid())
  ticketId       String
  content        String
  isFromCustomer Boolean       @default(true)
  isInternal     Boolean       @default(false)
  sentById       String?
  emailMessageId String?
  emailSentAt    DateTime?
  createdAt      DateTime      @default(now())
  sentBy         User?         @relation("SentTicketMessages", fields: [sentById], references: [id])
  ticket         SupportTicket @relation(fields: [ticketId], references: [id], onDelete: Cascade)

  @@index([ticketId])
  @@index([createdAt])
}

model KnowledgeBaseArticle {
  id              String         @id @default(cuid())
  title           String
  slug            String         @unique
  question        String
  answer          String
  category        TicketCategory @default(GENERAL)
  keywords        String[]
  viewCount       Int            @default(0)
  helpfulCount    Int            @default(0)
  notHelpfulCount Int            @default(0)
  sourceTicketIds String[]
  generatedBy     String?
  isPublished     Boolean        @default(false)
  publishedAt     DateTime?
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt

  @@index([category])
  @@index([isPublished])
  @@index([viewCount])
}

model ZombieProfile {
  id              String              @id @default(cuid())
  name            String
  avatar          String?
  location        String?
  personalityType String
  progressCurve   Json?
  backstory       String?
  isActive        Boolean             @default(true)
  createdAt       DateTime            @default(now())
  background      String?
  incomeLevel     String?
  isGraduate      Boolean             @default(false)
  tier            Int                 @default(2)
  graduatePosts   GraduatePost[]
  masterclassPods MasterclassPod[]    @relation("ZombieMasterclassPods")
  podMemberships  PodMember[]
  podMessages     PodMessage[]
  successEvents   SuccessEvent[]
  chatMessages    ZombieChatMessage[]

  @@index([personalityType])
  @@index([isActive])
  @@index([tier])
  @@index([isGraduate])
}

model StudyPod {
  id         String       @id @default(cuid())
  name       String
  cohortId   String?
  courseId   String?
  maxMembers Int          @default(5)
  isActive   Boolean      @default(true)
  createdAt  DateTime     @default(now())
  members    PodMember[]
  messages   PodMessage[]
  cohort     Cohort?      @relation(fields: [cohortId], references: [id])

  @@index([cohortId])
  @@index([isActive])
  @@index([createdAt])
}

model PodMember {
  id           String         @id @default(cuid())
  podId        String
  userId       String?
  zombieId     String?
  isZombie     Boolean        @default(false)
  isCoach      Boolean        @default(false)
  progress     Int            @default(0)
  lastActiveAt DateTime?
  joinedAt     DateTime       @default(now())
  pod          StudyPod       @relation(fields: [podId], references: [id], onDelete: Cascade)
  user         User?          @relation("UserPodMemberships", fields: [userId], references: [id])
  zombie       ZombieProfile? @relation(fields: [zombieId], references: [id])

  @@unique([podId, userId])
  @@index([podId])
  @@index([userId])
  @@index([zombieId])
}

model PodMessage {
  id        String         @id @default(cuid())
  podId     String
  senderId  String?
  zombieId  String?
  isCoach   Boolean        @default(false)
  isSystem  Boolean        @default(false)
  content   String
  offerTag  String?
  isRead    Boolean        @default(false)
  createdAt DateTime       @default(now())
  pod       StudyPod       @relation(fields: [podId], references: [id], onDelete: Cascade)
  sender    User?          @relation("UserPodMessages", fields: [senderId], references: [id])
  zombie    ZombieProfile? @relation(fields: [zombieId], references: [id])

  @@index([podId])
  @@index([senderId])
  @@index([createdAt])
}

model Cohort {
  id             String     @id @default(cuid())
  name           String
  slug           String     @unique
  courseCategory String?
  startDate      DateTime
  endDate        DateTime?
  targetCertDate DateTime?
  maxMembers     Int        @default(100)
  memberCount    Int        @default(0)
  isActive       Boolean    @default(true)
  createdAt      DateTime   @default(now())
  pods           StudyPod[]
  members        User[]     @relation("UserCohort")

  @@index([slug])
  @@index([courseCategory])
  @@index([isActive])
  @@index([startDate])
}

model SuccessEvent {
  id        String         @id @default(cuid())
  userId    String?
  zombieId  String?
  eventType String
  eventData Json?
  message   String?
  isZombie  Boolean        @default(false)
  isVisible Boolean        @default(true)
  createdAt DateTime       @default(now())
  user      User?          @relation("UserSuccessEvents", fields: [userId], references: [id])
  zombie    ZombieProfile? @relation(fields: [zombieId], references: [id])

  @@index([eventType])
  @@index([isVisible])
  @@index([createdAt])
}

model IncomeLog {
  id         String   @id @default(cuid())
  userId     String
  amount     Float
  source     String?
  clientName String?
  notes      String?
  loggedAt   DateTime @default(now())
  createdAt  DateTime @default(now())
  user       User     @relation("UserIncomeLogs", fields: [userId], references: [id])

  @@index([userId])
  @@index([loggedAt])
}

model IncomeMilestone {
  id         String   @id @default(cuid())
  userId     String
  milestone  String
  amount     Float
  celebrated Boolean  @default(false)
  reachedAt  DateTime @default(now())
  user       User     @relation("UserIncomeMilestones", fields: [userId], references: [id])

  @@unique([userId, milestone])
  @@index([userId])
  @@index([milestone])
}

model Referral {
  id           String    @id @default(cuid())
  referrerId   String
  referredId   String?
  code         String    @unique
  status       String    @default("pending")
  clickCount   Int       @default(0)
  rewardType   String?
  rewardAmount Float?
  rewardIssued Boolean   @default(false)
  convertedAt  DateTime?
  createdAt    DateTime  @default(now())
  referred     User?     @relation("UserReferralsReceived", fields: [referredId], references: [id])
  referrer     User      @relation("UserReferralsSent", fields: [referrerId], references: [id])

  @@index([referrerId])
  @@index([code])
  @@index([status])
}

model PodEngagement {
  id        String   @id @default(cuid())
  userId    String
  eventType String
  metadata  Json?
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([eventType])
  @@index([createdAt])
}

model PodUserMessage {
  id                  String   @id @default(cuid())
  userId              String
  content             String
  daysSinceEnrollment Int
  aiResponderName     String?
  aiResponse          String?
  createdAt           DateTime @default(now())
  user                User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([createdAt])
  @@index([daysSinceEnrollment])
}

model Payment {
  id                String        @id @default(cuid())
  userId            String
  amount            Decimal       @db.Decimal(10, 2)
  currency          String        @default("USD")
  transactionId     String?       @unique
  processorRef      String?
  paymentMethod     String?
  cardLast4         String?
  cardBrand         String?
  billingEmail      String?
  billingName       String?
  billingAddress    String?
  billingCity       String?
  billingState      String?
  billingZip        String?
  billingCountry    String?
  ipAddress         String?
  userAgent         String?
  deviceFingerprint String?
  productName       String?
  productSku        String?
  courseId          String?
  status            PaymentStatus @default(COMPLETED)
  refundedAt        DateTime?
  refundAmount      Decimal?      @db.Decimal(10, 2)
  chargebackAt      DateTime?
  createdAt         DateTime      @default(now())
  updatedAt         DateTime      @updatedAt
  paymentType       PaymentType   @default(FRONTEND)
  course            Course?       @relation(fields: [courseId], references: [id])
  user              User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([createdAt])
  @@index([status])
  @@index([userId, createdAt])
  @@index([status, createdAt])
  @@index([courseId, status])
}

model ResourceDownload {
  id         String         @id @default(cuid())
  userId     String
  resourceId String
  ipAddress  String?
  userAgent  String?
  createdAt  DateTime       @default(now())
  resource   LessonResource @relation(fields: [resourceId], references: [id], onDelete: Cascade)
  user       User           @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([resourceId])
  @@index([createdAt])
}

model AutoTagRule {
  id          String    @id @default(cuid())
  name        String
  trigger     String
  triggerData Json      @default("{}")
  action      String
  actionData  Json      @default("{}")
  isActive    Boolean   @default(true)
  runsCount   Int       @default(0)
  lastRunAt   DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  @@index([isActive])
  @@index([trigger])
}

model OracleEvent {
  id        String   @id @default(cuid())
  userId    String
  event     String
  metadata  Json?
  source    String?
  sessionId String?
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, createdAt])
  @@index([event, createdAt])
  @@index([createdAt])
}

model OracleAction {
  id          String    @id @default(cuid())
  userId      String
  actionType  String
  status      String    @default("pending")
  priority    Int       @default(5)
  template    String?
  subject     String?
  content     String
  metadata    Json?
  triggeredBy String
  triggerData Json?
  scheduledAt DateTime?
  executedAt  DateTime?
  outcome     Json?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId, status])
  @@index([status, scheduledAt])
  @@index([actionType, createdAt])
}

model OracleSegment {
  id              String    @id @default(cuid())
  userId          String    @unique
  engagementLevel String    @default("new")
  engagementScore Int       @default(50)
  churnRisk       Int       @default(0)
  churnReason     String?
  lifecycle       String    @default("lead")
  persona         String?
  learningStyle   String?
  ltv             Decimal?  @db.Decimal(10, 2)
  valueSegment    String?
  completionProb  Int?
  upgradeProb     Int?
  referralProb    Int?
  bestContactTime String?
  bestChannel     String?
  lastAnalyzed    DateTime?
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  user            User      @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model OracleRule {
  id             String    @id @default(cuid())
  name           String
  description    String?
  trigger        String
  conditions     Json
  actionType     String
  actionData     Json
  isActive       Boolean   @default(true)
  priority       Int       @default(5)
  cooldown       Int       @default(24)
  maxPerUser     Int?
  timesTriggered Int       @default(0)
  lastTriggered  DateTime?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  @@index([isActive, trigger])
}

model OracleInsight {
  id         String   @id @default(cuid())
  type       String
  title      String
  content    String
  confidence Int?
  metadata   Json?
  status     String   @default("new")
  createdAt  DateTime @default(now())

  @@index([type, status])
  @@index([createdAt])
}

model PushSubscription {
  id               String    @id @default(cuid())
  userId           String
  endpoint         String    @unique
  p256dh           String
  auth             String
  userAgent        String?
  deviceType       String?
  messagesEnabled  Boolean   @default(true)
  coursesEnabled   Boolean   @default(true)
  remindersEnabled Boolean   @default(true)
  marketingEnabled Boolean   @default(false)
  lastPushAt       DateTime?
  failureCount     Int       @default(0)
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
  user             User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([endpoint])
}

model LessonChatMessage {
  id           String   @id @default(cuid())
  content      String
  courseId     String
  userId       String?
  isZombie     Boolean  @default(false)
  zombieName   String?
  zombieAvatar String?
  createdAt    DateTime @default(now())
  course       Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)
  user         User?    @relation("LessonChatMessages", fields: [userId], references: [id])

  @@index([courseId, createdAt])
  @@index([isZombie])
}

model ZombieChatTemplate {
  id        String   @id @default(cuid())
  content   String
  category  String
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())

  @@index([category, isActive])
}

model MiniDiplomaExam {
  id                    String    @id @default(cuid())
  userId                String
  category              String
  score                 Int
  correctAnswers        Int
  totalQuestions        Int
  passed                Boolean   @default(false)
  scholarshipQualified  Boolean   @default(false)
  answers               Json
  attemptNumber         Int       @default(1)
  scholarshipCouponCode String?   @unique
  scholarshipExpiresAt  DateTime?
  scholarshipClaimedAt  DateTime?
  createdAt             DateTime  @default(now())
  certificateEmailSent  Boolean   @default(false)
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([category])
  @@index([scholarshipQualified])
  @@index([scholarshipCouponCode])
  @@index([certificateEmailSent, passed, createdAt])
}

model ScholarshipSpot {
  id         String   @id @default(cuid())
  month      Int
  year       Int
  category   String
  totalSpots Int      @default(3)
  usedSpots  Int      @default(0)
  claimedBy  String[]
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@unique([month, year, category])
  @@index([month, year])
}

model AuditLog {
  id        String      @id @default(cuid())
  userId    String
  userEmail String
  userRole  String
  action    AuditAction
  entity    String
  entityId  String?
  details   Json?
  ipAddress String?
  userAgent String?
  createdAt DateTime    @default(now())
  user      User        @relation("AuditLogs", fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([action])
  @@index([entity])
  @@index([createdAt])
}

model ZombieChatMessage {
  id               String         @id @default(cuid())
  videoTime        Int
  messageType      String
  content          String
  isActive         Boolean        @default(true)
  profileId        String?
  enrolleeName     String?
  enrolleeLocation String?
  createdAt        DateTime       @default(now())
  profile          ZombieProfile? @relation(fields: [profileId], references: [id])

  @@index([videoTime])
  @@index([messageType])
  @@index([isActive])
}

model GraduatePost {
  id        String         @id @default(cuid())
  postType  String
  content   String
  imageUrl  String?
  likes     Int            @default(0)
  comments  Json           @default("[]")
  isActive  Boolean        @default(true)
  isPinned  Boolean        @default(false)
  profileId String?
  userId    String?
  postedAt  DateTime       @default(now())
  createdAt DateTime       @default(now())
  profile   ZombieProfile? @relation(fields: [profileId], references: [id])
  user      User?          @relation("UserGraduatePosts", fields: [userId], references: [id])

  @@index([postType])
  @@index([isActive])
  @@index([postedAt])
  @@index([userId])
}

model LiveVSLSession {
  id               String               @id @default(cuid())
  visitorId        String
  userId           String?
  videoProgress    Int                  @default(0)
  maxProgress      Int                  @default(0)
  chatMessagesSent Int                  @default(0)
  checkoutViewed   Boolean              @default(false)
  checkoutViewedAt DateTime?
  enrolled         Boolean              @default(false)
  enrolledAt       DateTime?
  joinedAt         DateTime             @default(now())
  leftAt           DateTime?
  lastActivity     DateTime             @default(now())
  user             User?                @relation("UserVSLSessions", fields: [userId], references: [id])
  chatMessages     LiveVSLUserMessage[]

  @@index([userId])
  @@index([visitorId])
  @@index([joinedAt])
  @@index([enrolled])
}

model LiveVSLUserMessage {
  id            String         @id @default(cuid())
  sessionId     String
  userName      String
  message       String
  sarahResponse String?
  respondedAt   DateTime?
  createdAt     DateTime       @default(now())
  session       LiveVSLSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  @@index([sessionId])
  @@index([createdAt])
}

model SmartNudge {
  id          String    @id @default(cuid())
  userId      String
  triggerType String
  channel     String
  message     String
  sentAt      DateTime  @default(now())
  openedAt    DateTime?
  clickedAt   DateTime?
  user        User      @relation("UserSmartNudges", fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([triggerType])
  @@index([sentAt])
}

model OnboardingProgress {
  id                   String    @id @default(cuid())
  userId               String    @unique
  profileComplete      Boolean   @default(false)
  welcomeVideoWatched  Boolean   @default(false)
  firstMessageSent     Boolean   @default(false)
  firstLessonComplete  Boolean   @default(false)
  communityIntro       Boolean   @default(false)
  resourceDownloaded   Boolean   @default(false)
  profileNudgeSentAt   DateTime?
  messageNudgeSentAt   DateTime?
  lessonNudgeSentAt    DateTime?
  communityNudgeSentAt DateTime?
  completedAt          DateTime?
  createdAt            DateTime  @default(now())
  updatedAt            DateTime  @updatedAt
  user                 User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([completedAt])
  @@index([createdAt])
}

model DailyReport {
  id                       String   @id @default(cuid())
  reportDate               DateTime @unique
  newStudentsToday         Int      @default(0)
  newLeadsToday            Int      @default(0)
  totalStudents            Int      @default(0)
  totalLeads               Int      @default(0)
  newEnrollmentsToday      Int      @default(0)
  courseBreakdown          Json?
  ticketsOpenedToday       Int      @default(0)
  ticketsResolvedToday     Int      @default(0)
  ticketsPending           Int      @default(0)
  messagesReceivedToday    Int      @default(0)
  messagesSentToday        Int      @default(0)
  miniDiplomasStarted      Int      @default(0)
  miniDiplomasCompleted    Int      @default(0)
  sequenceEnrollmentsToday Int      @default(0)
  emailsSentToday          Int      @default(0)
  rawData                  Json?
  createdAt                DateTime @default(now())

  @@index([reportDate])
  @@index([createdAt])
}

model MasterclassPod {
  id                   String                   @id @default(cuid())
  userId               String                   @unique
  zombieProfileId      String
  nicheCategory        String
  examScore            Int
  examPassedAt         DateTime
  status               String                   @default("waiting")
  masterclassDay       Int                      @default(0)
  startedAt            DateTime?
  scholarshipOfferedAt DateTime?
  scholarshipExpiresAt DateTime?
  scholarshipUsed      Boolean                  @default(false)
  convertedAt          DateTime?
  conversionValue      Decimal?                 @db.Decimal(10, 2)
  createdAt            DateTime                 @default(now())
  updatedAt            DateTime                 @updatedAt
  unlockedResources    Json                     @default("[]")
  dayProgress          MasterclassDayProgress[]
  messages             MasterclassMessage[]
  user                 User                     @relation("UserMasterclassPod", fields: [userId], references: [id], onDelete: Cascade)
  zombieProfile        ZombieProfile            @relation("ZombieMasterclassPods", fields: [zombieProfileId], references: [id])

  @@index([status])
  @@index([masterclassDay])
  @@index([nicheCategory])
  @@index([scholarshipExpiresAt])
  @@index([createdAt])
}

model MasterclassDayProgress {
  id                String         @id @default(cuid())
  podId             String
  dayNumber         Int
  lessonDeliveredAt DateTime?
  audioUrl          String?
  lessonViewedAt    DateTime?
  messagesRead      Int            @default(0)
  userReplied       Boolean        @default(false)
  gapTopic          String?
  gapEngaged        Boolean        @default(false)
  createdAt         DateTime       @default(now())
  pod               MasterclassPod @relation(fields: [podId], references: [id], onDelete: Cascade)

  @@unique([podId, dayNumber])
  @@index([podId])
  @@index([dayNumber])
}

model MasterclassMessage {
  id           String         @id @default(cuid())
  podId        String
  dayNumber    Int
  senderType   String
  senderName   String?
  senderAvatar String?
  content      String
  audioUrl     String?
  isSystem     Boolean        @default(false)
  offerMention String?
  readAt       DateTime?
  scheduledFor DateTime?
  sentAt       DateTime?
  createdAt    DateTime       @default(now())
  pod          MasterclassPod @relation(fields: [podId], references: [id], onDelete: Cascade)

  @@index([podId, dayNumber])
  @@index([senderType])
  @@index([scheduledFor])
  @@index([createdAt])
}

model MasterclassTemplate {
  id             String   @id @default(cuid())
  nicheCategory  String
  dayNumber      Int
  sarahAudioUrl  String?
  sarahMessage   String
  lessonTitle    String
  lessonSummary  String?
  zombieMessages Json
  gapTopic       String?
  gapDescription String?
  includesOffer  Boolean  @default(false)
  offerType      String?
  isActive       Boolean  @default(true)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@unique([nicheCategory, dayNumber])
  @@index([nicheCategory])
  @@index([dayNumber])
}

enum UserRole {
  STUDENT
  INSTRUCTOR
  MENTOR
  ADMIN
  SUPERUSER
  SUPPORT
}

enum UserType {
  LEAD
  STUDENT
}

enum Difficulty {
  BEGINNER
  INTERMEDIATE
  ADVANCED
  EXPERT
}

enum CertificateType {
  COMPLETION
  CERTIFICATION
  MINI_DIPLOMA
  MODULE_COMPLETION
}

enum LessonType {
  VIDEO
  TEXT
  QUIZ
  ASSIGNMENT
  LIVE_SESSION
  INTERACTIVE
}

enum ResourceType {
  PDF
  DOCUMENT
  SPREADSHEET
  IMAGE
  AUDIO
  LINK
  OTHER
}

enum EnrollmentStatus {
  ACTIVE
  COMPLETED
  PAUSED
  EXPIRED
  CANCELLED
}

enum NoteType {
  NOTE
  HIGHLIGHT
}

enum QuestionType {
  MULTIPLE_CHOICE
  MULTI_SELECT
  TRUE_FALSE
}

enum ChannelType {
  GLOBAL_WINS
  GLOBAL_ANNOUNCEMENTS
  GLOBAL_LOUNGE
  INTRODUCTIONS
  WINS
  QUESTIONS
  TIPS
}

enum MessageType {
  DIRECT
  SYSTEM
  NOTIFICATION
  MENTORSHIP
}

enum SessionStatus {
  PENDING
  CONFIRMED
  COMPLETED
  CANCELLED
}

enum NotificationType {
  LESSON_COMPLETE
  MODULE_COMPLETE
  COURSE_COMPLETE
  CERTIFICATE_ISSUED
  NEW_MESSAGE
  MENTOR_REQUEST
  COMMUNITY_REPLY
  SYSTEM
  PROMOTION
}

enum BulkEmailStatus {
  DRAFT
  SCHEDULED
  SENDING
  SENT
  FAILED
}

enum TagCategory {
  STAGE
  INTENT
  BEHAVIOR
  SOURCE
  SUPPRESS
  CUSTOM
}

enum SequenceTrigger {
  TAG_ADDED
  USER_REGISTERED
  MINI_DIPLOMA_STARTED
  MINI_DIPLOMA_COMPLETED
  TRAINING_STARTED
  CHALLENGE_STARTED
  CHALLENGE_COMPLETED
  COURSE_ENROLLED
  MANUAL
}

enum SequenceEnrollmentStatus {
  ACTIVE
  COMPLETED
  EXITED
  PAUSED
}

enum EmailStatus {
  QUEUED
  SENDING
  SENT
  DELIVERED
  OPENED
  CLICKED
  BOUNCED
  COMPLAINED
  UNSUBSCRIBED
  FAILED
}

enum CreditTier {
  UNKNOWN
  UNDER_620
  TIER_620_679
  TIER_680_PLUS
}

enum JobStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
  CANCELLED
}

enum ResourceCategory {
  COACHING_PROGRAM
  MEAL_PLAN
  PROTOCOL
  CLIENT_MATERIALS
  BUSINESS_TEMPLATES
  SOCIAL_MEDIA
  WORKSHEETS
  OTHER
}

enum ResourceAccess {
  FREE
  ENROLLED
  CERTIFIED
  PREMIUM
}

enum ClientStatus {
  ACTIVE
  INACTIVE
  COMPLETED
  PAUSED
}

enum ProtocolStatus {
  DRAFT
  ACTIVE
  COMPLETED
  PAUSED
}

enum DFYProductType {
  CORE_PROGRAM
  SPECIALTY_KIT
  BUNDLE
  TEMPLATE_PACK
  MARKETING_KIT
  EBOOK
}

enum PurchaseStatus {
  PENDING
  COMPLETED
  REFUNDED
}

enum FulfillmentStatus {
  PENDING
  INTAKE_RECEIVED
  IN_PROGRESS
  DELIVERED
}

enum EmailCategory {
  ACCOUNT
  MINI_DIPLOMA
  GRADUATE
  CERTIFICATION
  ENGAGEMENT
  RESOURCES
  MARKETING
}

enum TicketStatus {
  NEW
  OPEN
  PENDING
  RESOLVED
  CLOSED
}

enum TicketPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum TicketCategory {
  BILLING
  TECHNICAL
  ACCESS
  CERTIFICATES
  COURSE_CONTENT
  REFUND
  GENERAL
}

enum TicketDepartment {
  SUPPORT
  BILLING
  LEGAL
  ACADEMIC
  CREDENTIALING
  TECHNICAL
}

enum PaymentStatus {
  PENDING
  COMPLETED
  REFUNDED
  DISPUTED
  CHARGEBACK
}

enum PaymentType {
  FRONTEND
  OTO
  BUMP
  SUBSCRIPTION
}

enum AuditAction {
  USER_CREATE
  USER_UPDATE
  USER_DELETE
  USER_ROLE_CHANGE
  USER_IMPERSONATE
  COURSE_CREATE
  COURSE_UPDATE
  COURSE_DELETE
  COURSE_PUBLISH
  COURSE_UNPUBLISH
  BULK_EMAIL_SEND
  BULK_DM_SEND
  EMAIL_TEMPLATE_UPDATE
  REFUND_PROCESS
  PURCHASE_MANUAL
  SETTINGS_UPDATE
  CERTIFICATE_REVOKE
  ENROLLMENT_DELETE
  DATA_EXPORT
  IMPERSONATE_START
  IMPERSONATE_STOP
  STATUS_CHANGE
}
